# Домашнее задание к занятию "12.3 Развертывание кластера на собственных серверах, лекция 1"
Поработав с персональным кластером, можно заняться проектами. Вам пришла задача подготовить кластер под новый проект.

## Задание 1: Описать требования к кластеру

### Вопрос
Сначала проекту необходимо определить требуемые ресурсы. Известно, что проекту нужны база данных, система кеширования, а само приложение состоит из бекенда и фронтенда. Опишите, какие ресурсы нужны, если известно:

* База данных должна быть отказоустойчивой. Потребляет 4 ГБ ОЗУ в работе, 1 ядро. 3 копии.
* Кэш должен быть отказоустойчивый. Потребляет 4 ГБ ОЗУ в работе, 1 ядро. 3 копии.
* Фронтенд обрабатывает внешние запросы быстро, отдавая статику. Потребляет не более 50 МБ ОЗУ на каждый экземпляр, 0.2 ядра. 5 копий.
* Бекенд потребляет 600 МБ ОЗУ и по 1 ядру на копию. 10 копий.

План расчета
1. Сначала сделайте расчет всех необходимых ресурсов.
2. Затем прикиньте количество рабочих нод, которые справятся с такой нагрузкой.
3. Добавьте к полученным цифрам запас, который учитывает выход из строя как минимум одной ноды.
4. Добавьте служебные ресурсы к нодам. Помните, что для разных типов нод требовния к ресурсам разные.
5. Рассчитайте итоговые цифры.
6. В результате должно быть указано количество нод и их параметры.

### Ответ

1. Исходим из того, что нам нужен отказоустойчивый кластер, а значит должен быть дубль мастер-ноды. Т.к. 2 мастер-ноды не делают, то планируем минимум 3 мастер-ноды с параметрами 2 ядра, 2 ГБ ОЗУ каждая.
2. Не уверен что для этой задачи правильно, но неоднократно отмечалось, что размещение БД в контейнерах — плохая практика. Поэтому все копии БД размещаем на отдельных ВМ с параметрами 1 ядро, 4 ГБ ОЗУ каждая.
3. Считаем необходимое количество ресурсов для кэша, фронта и бэка:
   - Ядер: 1 ядро * 3 копии кэш + 0,2 ядро * 5 копий фронт + 1 ядро * 10 копий бэк = 14 ядер;     
   - ОЗУ : 4 ГБ   * 3 копии кэш + 0,05 ГБ  * 5 копий фронт + 0,6 ГБ * 10 копий бэк = 18,25 ГБ.
4. Требуемые ресурсы из п.3 можно распределить на 3 ноды с параметрами 6 ядер, 8 ГБ ОЗУ каждая, что будет достаточно для работы всех экземпляров сервисов и работы ОС самой ноды. Дополнительно, есть требование по наличию запаса на случай выхода одной ноды, поэтому создаем не 3, а 4 таких ноды.       

**Итоговое количество машин:** 

- 3 мастер-ноды (2 ядра, 2 ГБ ОЗУ),
- 3 ВМ с БД (1 ядро, 4 ГБ ОЗУ),
- 4 ноды (6 ядер, 8 ГБ ОЗУ).